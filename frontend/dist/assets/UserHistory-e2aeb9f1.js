import{U as V}from"./UserLayout-c3bc48f7.js";import{_ as D,r as l,v as L,o as N,a as r,b as m,c as z,w as a,d as w,e as s,f as k,g as i,h as f,t as v,p}from"./index-a1ba2a77.js";const I={name:"UserHistory",components:{UserLayout:V},setup(){const u=l("chats"),t=l(!1),h=l([]),e=l([]),x=l([{title:"聊天機器人",key:"chat_link_name",width:"25%"},{title:"訊息內容",key:"message",width:"50%"},{title:"時間",key:"created_at",width:"25%"}]),H=l([{title:"操作類型",key:"action",width:"25%"},{title:"詳細資訊",key:"details",width:"50%"},{title:"時間",key:"timestamp",width:"25%"}]),_=o=>{const d=new Date(o);return new Intl.DateTimeFormat("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).format(d)},y=o=>({LOGIN:"success",LOGOUT:"error",VIEW_CHAT_LINK:"primary",UPDATE_PROFILE:"info"})[o]||"secondary",c=async()=>{t.value=!0;try{const o=await w.get("/api/user-profiles/chat-history");o.data.success&&(h.value=o.data.data||[])}catch(o){console.error("獲取聊天紀錄失敗:",o)}finally{t.value=!1}},g=async()=>{t.value=!0;try{const o=await w.get("/api/user-profiles/operation-logs");o.data.success&&(e.value=o.data.data||[])}catch(o){console.error("獲取操作紀錄失敗:",o)}finally{t.value=!1}};return L(u,o=>{o==="chats"?c():o==="operations"&&g()}),N(()=>{c()}),{activeTab:u,loading:t,chatHistory:h,operationHistory:e,chatHeaders:x,operationHeaders:H,formatDate:_,getActionColor:y}}},O={key:0},A={key:0,class:"text-center py-5"},B={key:1},E={key:0,class:"text-center py-5"};function F(u,t,h,e,x,H){const _=r("v-col"),y=r("v-row"),c=r("v-tab"),g=r("v-tabs"),o=r("v-chip"),d=r("v-data-table"),b=r("v-icon"),T=r("v-card-text"),C=r("v-card"),U=r("UserLayout");return m(),z(U,null,{default:a(()=>[s(y,null,{default:a(()=>[s(_,{cols:"12"},{default:a(()=>t[1]||(t[1]=[k("h1",{class:"text-h4 mb-6"},"使用紀錄",-1)])),_:1})]),_:1}),s(y,null,{default:a(()=>[s(_,{cols:"12"},{default:a(()=>[s(C,null,{default:a(()=>[s(g,{modelValue:e.activeTab,"onUpdate:modelValue":t[0]||(t[0]=n=>e.activeTab=n)},{default:a(()=>[s(c,{value:"chats"},{default:a(()=>t[2]||(t[2]=[i("聊天紀錄")])),_:1}),s(c,{value:"operations"},{default:a(()=>t[3]||(t[3]=[i("操作紀錄")])),_:1})]),_:1},8,["modelValue"]),s(T,null,{default:a(()=>[e.activeTab==="chats"?(m(),f("div",O,[s(d,{headers:e.chatHeaders,items:e.chatHistory,loading:e.loading,"items-per-page":10,class:"elevation-1"},{"item.chat_link_name":a(({item:n})=>[s(o,{size:"small",color:"primary"},{default:a(()=>[i(v(n.chat_link_name),1)]),_:2},1024)]),"item.created_at":a(({item:n})=>[i(v(e.formatDate(n.created_at)),1)]),_:1},8,["headers","items","loading"]),e.chatHistory.length===0&&!e.loading?(m(),f("div",A,[s(b,{size:"48",color:"grey-lighten-1"},{default:a(()=>t[4]||(t[4]=[i("mdi-chat-remove")])),_:1}),t[5]||(t[5]=k("p",{class:"text-body-1 mt-2 text-grey"},"暫無聊天紀錄",-1))])):p("",!0)])):p("",!0),e.activeTab==="operations"?(m(),f("div",B,[s(d,{headers:e.operationHeaders,items:e.operationHistory,loading:e.loading,"items-per-page":10,class:"elevation-1"},{"item.action":a(({item:n})=>[s(o,{size:"small",color:e.getActionColor(n.action)},{default:a(()=>[i(v(n.action),1)]),_:2},1032,["color"])]),"item.timestamp":a(({item:n})=>[i(v(e.formatDate(n.timestamp)),1)]),_:1},8,["headers","items","loading"]),e.operationHistory.length===0&&!e.loading?(m(),f("div",E,[s(b,{size:"48",color:"grey-lighten-1"},{default:a(()=>t[6]||(t[6]=[i("mdi-history")])),_:1}),t[7]||(t[7]=k("p",{class:"text-body-1 mt-2 text-grey"},"暫無操作紀錄",-1))])):p("",!0)])):p("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}const W=D(I,[["render",F]]);export{W as default};
