import{_ as E,r as m,u as R,k as I,o as T,a,b as p,c as A,w as o,e as t,f as w,h as L,p as U,n as P,i as D,F,g as _,t as b,m as j,q,d as J,s as O}from"./index-a1ba2a77.js";const G={name:"AdminLayout",setup(){const v=m(!0),n=m(!0),f=R(),e=m(null),s=m(!1),g=[{title:"儀表板",icon:"mdi-view-dashboard-outline",to:"/dashboard"},{title:"使用者管理",icon:"mdi-account-cog-outline",to:"/users"},{title:"群組管理",icon:"mdi-account-group-outline",to:"/groups"},{title:"聊天連結管理",icon:"mdi-link-variant-plus",to:"/chat-links"},{title:"憑證管理",icon:"mdi-key-variant",to:"/credentials"},{title:"AD 設定",icon:"mdi-microsoft-azure",to:"/ad-config"},{title:"操作紀錄",icon:"mdi-clipboard-text-clock-outline",to:"/logs"}],c=I(()=>{const i=f.currentRoute.value,r=g.find(y=>y.to===i.path);return r?r.title:"管理平台"}),u=I(()=>{var i;return(i=e.value)!=null&&i.full_name?e.value.full_name.split(" ").map(r=>r.charAt(0)).join("").toUpperCase():"?"});return T(()=>{const i=localStorage.getItem("user");if(i)try{e.value=JSON.parse(i)}catch(r){console.error("解析使用者數據時發生錯誤",r)}}),{drawer:v,rail:n,menuItems:g,pageTitle:c,user:e,userInitials:u,logout:async()=>{try{await J.post("/api/auth/logout")}catch(i){console.error("登出時發生錯誤:",i)}finally{localStorage.removeItem("token"),localStorage.removeItem("user"),f.push("/login")}},isPinned:s,handleMouseEnter:()=>{n.value=!1},handleMouseLeave:()=>{s.value||(n.value=!0)},togglePin:()=>{s.value=!s.value,s.value||(n.value=!0)}}}},H={class:"pa-2"},K={key:0},Q={class:"text-h6 text-white"};function W(v,n,f,e,s,g){const c=a("v-btn"),u=a("v-list-item"),h=a("v-divider"),d=a("v-icon"),k=a("v-list"),C=a("v-navigation-drawer"),i=a("v-app-bar-title"),r=a("v-spacer"),y=a("v-avatar"),M=a("v-list-item-title"),V=a("v-menu"),S=a("v-app-bar"),z=a("v-container"),N=a("v-main"),B=a("v-app");return p(),A(B,null,{default:o(()=>[t(C,{modelValue:e.drawer,"onUpdate:modelValue":n[1]||(n[1]=l=>e.drawer=l),rail:e.rail,onMouseenter:e.handleMouseEnter,onMouseleave:e.handleMouseLeave,permanent:"",color:"secondary",theme:"dark"},{append:o(()=>[w("div",H,[t(c,{block:"",color:"error",variant:"tonal",onClick:e.logout},{default:o(()=>[t(d,{icon:"mdi-logout"}),e.rail?U("",!0):(p(),L("span",K,"登出"))]),_:1},8,["onClick"])])]),default:o(()=>[t(u,{title:e.rail?"":"AI Chat 管理平台",nav:""},{append:o(()=>[t(c,{variant:"text",icon:e.isPinned?"mdi-pin":"mdi-pin-outline",onClick:P(e.togglePin,["stop"]),color:e.isPinned?"warning":"grey-lighten-1",class:"mr-1",size:"small"},null,8,["icon","onClick","color"]),t(c,{variant:"text",icon:"mdi-chevron-left",onClick:n[0]||(n[0]=P(l=>e.rail=!e.rail,["stop"]))})]),_:1},8,["title"]),t(h),t(k,{density:"compact",nav:""},{default:o(()=>[(p(!0),L(F,null,D(e.menuItems,l=>(p(),A(u,{key:l.title,title:e.rail?"":l.title,to:l.to,value:l.title,class:O({"active-link":v.$route.path===l.to})},{prepend:o(()=>[t(d,{icon:l.icon,color:v.$route.path===l.to?"white":"grey-lighten-1",size:"24"},null,8,["icon","color"])]),_:2},1032,["title","to","value","class"]))),128))]),_:1})]),_:1},8,["modelValue","rail","onMouseenter","onMouseleave"]),t(S,{color:"white",elevation:1},{default:o(()=>[t(i,null,{default:o(()=>[_(b(e.pageTitle),1)]),_:1}),t(r),t(V,null,{activator:o(({props:l})=>[t(c,j(l,{variant:"text"}),{default:o(()=>{var x;return[t(y,{size:"32",color:"primary",class:"mr-2"},{default:o(()=>[w("span",Q,b(e.userInitials),1)]),_:1}),w("span",null,b((x=e.user)==null?void 0:x.full_name),1),t(d,{right:""},{default:o(()=>n[2]||(n[2]=[_("mdi-chevron-down")])),_:1})]}),_:2},1040)]),default:o(()=>[t(k,null,{default:o(()=>[t(u,{to:"/profile"},{default:o(()=>[t(M,null,{default:o(()=>[t(d,{class:"mr-2"},{default:o(()=>n[3]||(n[3]=[_("mdi-account")])),_:1}),n[4]||(n[4]=_(" 個人設定 "))]),_:1})]),_:1}),t(h),t(u,{onClick:e.logout},{default:o(()=>[t(M,null,{default:o(()=>[t(d,{class:"mr-2"},{default:o(()=>n[5]||(n[5]=[_("mdi-logout")])),_:1}),n[6]||(n[6]=_(" 登出 "))]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),t(N,null,{default:o(()=>[t(z,{fluid:""},{default:o(()=>[q(v.$slots,"default",{},void 0,!0)]),_:3})]),_:3})]),_:3})}const Y=E(G,[["render",W],["__scopeId","data-v-81cbe164"]]);export{Y as A};
