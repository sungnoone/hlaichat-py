import{_ as E,r as m,u as R,k as I,o as T,a,b as p,c as L,w as o,e,f as k,h as P,p as A,n as U,i as F,F as j,g as _,t as w,m as q,q as D,d as J,s as O}from"./index-a1ba2a77.js";const G={name:"UserLayout",setup(){const v=m(!0),n=m(!0),f=R(),t=m(null),g=[{title:"我的聊天機器人",icon:"mdi-robot-happy-outline",to:"/user-dashboard"},{title:"使用紀錄",icon:"mdi-clipboard-text-clock-outline",to:"/user-history"}],C=I(()=>{const r=f.currentRoute.value,i=g.find(y=>y.to===r.path);return i?i.title:"使用平台"}),c=I(()=>{var r;return(r=t.value)!=null&&r.full_name?t.value.full_name.split(" ").map(i=>i.charAt(0)).join("").toUpperCase():"?"});T(()=>{const r=localStorage.getItem("user");if(r)try{t.value=JSON.parse(r)}catch(i){console.error("解析使用者數據時發生錯誤",i)}});const u=async()=>{try{await J.post("/api/auth/logout")}catch(r){console.error("登出時發生錯誤:",r)}finally{localStorage.removeItem("token"),localStorage.removeItem("user"),f.push("/login")}},s=m(!1);return{drawer:v,rail:n,menuItems:g,pageTitle:C,user:t,userInitials:c,logout:u,isPinned:s,handleMouseEnter:()=>{n.value=!1},handleMouseLeave:()=>{s.value||(n.value=!0)},togglePin:()=>{s.value=!s.value,s.value||(n.value=!0)}}}},H={class:"pa-2"},K={key:0},Q={class:"text-h6 text-white"};function W(v,n,f,t,g,C){const c=a("v-btn"),u=a("v-list-item"),s=a("v-divider"),d=a("v-icon"),h=a("v-list"),M=a("v-navigation-drawer"),r=a("v-app-bar-title"),i=a("v-spacer"),y=a("v-avatar"),b=a("v-list-item-title"),V=a("v-menu"),S=a("v-app-bar"),N=a("v-container"),z=a("v-main"),B=a("v-app");return p(),L(B,null,{default:o(()=>[e(M,{modelValue:t.drawer,"onUpdate:modelValue":n[1]||(n[1]=l=>t.drawer=l),rail:t.rail,onMouseenter:t.handleMouseEnter,onMouseleave:t.handleMouseLeave,permanent:"",color:"primary",theme:"dark"},{append:o(()=>[k("div",H,[e(c,{block:"",color:"error",variant:"tonal",onClick:t.logout},{default:o(()=>[e(d,{icon:"mdi-logout"}),t.rail?A("",!0):(p(),P("span",K,"登出"))]),_:1},8,["onClick"])])]),default:o(()=>[e(u,{title:t.rail?"":"AI Chat 使用平台",nav:""},{append:o(()=>[e(c,{variant:"text",icon:t.isPinned?"mdi-pin":"mdi-pin-outline",onClick:U(t.togglePin,["stop"]),color:t.isPinned?"warning":"grey-lighten-1",class:"mr-1",size:"small"},null,8,["icon","onClick","color"]),e(c,{variant:"text",icon:"mdi-chevron-left",onClick:n[0]||(n[0]=U(l=>t.rail=!t.rail,["stop"]))})]),_:1},8,["title"]),e(s),e(h,{density:"compact",nav:""},{default:o(()=>[(p(!0),P(j,null,F(t.menuItems,l=>(p(),L(u,{key:l.title,title:t.rail?"":l.title,to:l.to,value:l.title,class:O({"active-link":v.$route.path===l.to})},{prepend:o(()=>[e(d,{icon:l.icon,color:v.$route.path===l.to?"white":"grey-lighten-1",size:"24"},null,8,["icon","color"])]),_:2},1032,["title","to","value","class"]))),128))]),_:1})]),_:1},8,["modelValue","rail","onMouseenter","onMouseleave"]),e(S,{color:"white",elevation:1},{default:o(()=>[e(r,null,{default:o(()=>[_(w(t.pageTitle),1)]),_:1}),e(i),e(V,null,{activator:o(({props:l})=>[e(c,q(l,{variant:"text"}),{default:o(()=>{var x;return[e(y,{size:"32",color:"primary",class:"mr-2"},{default:o(()=>[k("span",Q,w(t.userInitials),1)]),_:1}),k("span",null,w((x=t.user)==null?void 0:x.full_name),1),e(d,{right:""},{default:o(()=>n[2]||(n[2]=[_("mdi-chevron-down")])),_:1})]}),_:2},1040)]),default:o(()=>[e(h,null,{default:o(()=>[e(u,{to:"/user-profile"},{default:o(()=>[e(b,null,{default:o(()=>[e(d,{class:"mr-2"},{default:o(()=>n[3]||(n[3]=[_("mdi-account")])),_:1}),n[4]||(n[4]=_(" 個人設定 "))]),_:1})]),_:1}),e(s),e(u,{onClick:t.logout},{default:o(()=>[e(b,null,{default:o(()=>[e(d,{class:"mr-2"},{default:o(()=>n[5]||(n[5]=[_("mdi-logout")])),_:1}),n[6]||(n[6]=_(" 登出 "))]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),e(z,null,{default:o(()=>[e(N,{fluid:""},{default:o(()=>[D(v.$slots,"default",{},void 0,!0)]),_:3})]),_:3})]),_:3})}const Y=E(G,[["render",W],["__scopeId","data-v-76854472"]]);export{Y as U};
