import{A as F}from"./AdminLayout-918e61dc.js";import{_ as R,r as h,o as T,a as r,b as d,c as k,w as e,d as L,e as t,f as n,g as _,t as u,h as m,i as N,F as S}from"./index-a1ba2a77.js";const H={name:"Dashboard",components:{AdminLayout:F},setup(){const g=h(!1),s=h({userCount:0,groupCount:0,chatLinkCount:0}),f=h([]),o=h([]),C=l=>new Date(l).toLocaleDateString("zh-TW"),z=async()=>{var l;try{const a=await L.get("/api/stats",{timeout:5e3});a.data&&a.data.success?s.value=a.data.data||{userCount:0,groupCount:0,chatLinkCount:0}:console.error("獲取統計數據失敗:",((l=a.data)==null?void 0:l.message)||"未知錯誤")}catch(a){console.error("獲取統計數據失敗:",a)}},i=async()=>{var l;try{const a=await L.get("/api/logs/recent",{params:{limit:5},timeout:5e3});a.data&&a.data.success?f.value=a.data.data||[]:(console.error("獲取最近操作記錄失敗:",((l=a.data)==null?void 0:l.message)||"未知錯誤"),f.value=[])}catch(a){console.error("獲取最近操作記錄失敗:",a),f.value=[]}},p=async()=>{var l;try{const a=await L.get("/api/chat-links/recent",{params:{limit:5},timeout:5e3});a.data&&a.data.success?o.value=a.data.data||[]:(console.error("獲取最新聊天連結失敗:",((l=a.data)==null?void 0:l.message)||"未知錯誤"),o.value=[])}catch(a){console.error("獲取最新聊天連結失敗:",a),o.value=[]}};return T(()=>{g.value=!0,Promise.all([z(),i(),p()]).finally(()=>{g.value=!1})}),{loading:g,stats:s,logs:f,chatLinks:o,formatDate:C}}},M={class:"text-h4"},P={class:"text-h4"},W={class:"text-h4"},j={key:1,class:"text-center py-5 text-grey"},q={key:1,class:"text-center py-5 text-grey"};function G(g,s,f,o,C,z){const i=r("v-col"),p=r("v-row"),l=r("v-icon"),a=r("v-avatar"),v=r("v-card-title"),x=r("v-card-subtitle"),b=r("v-card-item"),y=r("v-card"),w=r("v-spacer"),D=r("v-btn"),A=r("v-table"),B=r("v-card-text"),V=r("v-chip"),E=r("AdminLayout");return d(),k(E,null,{default:e(()=>[t(p,null,{default:e(()=>[t(i,{cols:"12"},{default:e(()=>s[0]||(s[0]=[n("h1",{class:"text-h4 mb-6"},"儀表板",-1)])),_:1})]),_:1}),t(p,null,{default:e(()=>[t(i,{cols:"12",md:"4"},{default:e(()=>[t(y,{class:"mb-4"},{default:e(()=>[t(b,null,{prepend:e(()=>[t(a,{color:"primary",size:"48",rounded:"0"},{default:e(()=>[t(l,{icon:"mdi-account-multiple",size:"large"})]),_:1})]),default:e(()=>[t(v,null,{default:e(()=>s[1]||(s[1]=[_("使用者數量")])),_:1}),t(x,{class:"mt-2"},{default:e(()=>[n("span",M,u(o.stats.userCount||0),1)]),_:1})]),_:1})]),_:1})]),_:1}),t(i,{cols:"12",md:"4"},{default:e(()=>[t(y,{class:"mb-4"},{default:e(()=>[t(b,null,{prepend:e(()=>[t(a,{color:"info",size:"48",rounded:"0"},{default:e(()=>[t(l,{icon:"mdi-account-group",size:"large"})]),_:1})]),default:e(()=>[t(v,null,{default:e(()=>s[2]||(s[2]=[_("群組數量")])),_:1}),t(x,{class:"mt-2"},{default:e(()=>[n("span",P,u(o.stats.groupCount||0),1)]),_:1})]),_:1})]),_:1})]),_:1}),t(i,{cols:"12",md:"4"},{default:e(()=>[t(y,{class:"mb-4"},{default:e(()=>[t(b,null,{prepend:e(()=>[t(a,{color:"success",size:"48",rounded:"0"},{default:e(()=>[t(l,{icon:"mdi-link-variant",size:"large"})]),_:1})]),default:e(()=>[t(v,null,{default:e(()=>s[3]||(s[3]=[_("聊天連結數量")])),_:1}),t(x,{class:"mt-2"},{default:e(()=>[n("span",W,u(o.stats.chatLinkCount||0),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(p,null,{default:e(()=>[t(i,{cols:"12",md:"6"},{default:e(()=>[t(y,{class:"mb-4"},{default:e(()=>[t(v,{class:"d-flex align-center"},{default:e(()=>[t(l,{icon:"mdi-history",class:"mr-2"}),s[5]||(s[5]=_(" 最近操作記錄 ")),t(w),t(D,{variant:"text",size:"small",to:"/logs",class:"text-none"},{default:e(()=>s[4]||(s[4]=[_(" 查看全部 ")])),_:1})]),_:1}),t(B,null,{default:e(()=>[o.logs.length>0?(d(),k(A,{key:0},{default:e(()=>[s[6]||(s[6]=n("thead",null,[n("tr",null,[n("th",null,"使用者"),n("th",null,"操作"),n("th",null,"時間")])],-1)),n("tbody",null,[(d(!0),m(S,null,N(o.logs,c=>(d(),m("tr",{key:c.id},[n("td",null,u(c.user_full_name),1),n("td",null,u(c.action),1),n("td",null,u(o.formatDate(c.timestamp)),1)]))),128))])]),_:1})):(d(),m("div",j," 尚無操作記錄 "))]),_:1})]),_:1})]),_:1}),t(i,{cols:"12",md:"6"},{default:e(()=>[t(y,{class:"mb-4"},{default:e(()=>[t(v,{class:"d-flex align-center"},{default:e(()=>[t(l,{icon:"mdi-link-variant",class:"mr-2"}),s[8]||(s[8]=_(" 最新聊天連結 ")),t(w),t(D,{variant:"text",size:"small",to:"/chat-links",class:"text-none"},{default:e(()=>s[7]||(s[7]=[_(" 查看全部 ")])),_:1})]),_:1}),t(B,null,{default:e(()=>[o.chatLinks.length>0?(d(),k(A,{key:0},{default:e(()=>[s[9]||(s[9]=n("thead",null,[n("tr",null,[n("th",null,"名稱"),n("th",null,"類型"),n("th",null,"建立時間")])],-1)),n("tbody",null,[(d(!0),m(S,null,N(o.chatLinks,c=>(d(),m("tr",{key:c.id},[n("td",null,u(c.name),1),n("td",null,[t(V,{size:"small",color:c.link_type==="hosted"?"primary":"secondary"},{default:e(()=>[_(u(c.link_type==="hosted"?"Hosted":"Embedded"),1)]),_:2},1032,["color"])]),n("td",null,u(o.formatDate(c.created_at)),1)]))),128))])]),_:1})):(d(),m("div",q," 尚無聊天連結 "))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}const K=R(H,[["render",G]]);export{K as default};
